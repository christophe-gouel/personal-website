<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Papers – Christophe Gouel</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-707d8167ce6003fca903bfe2be84ab7f.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-0be8949dc84b3fefec59b0df82393ad5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-e7f4145358ce1d0cd37d8d374dbb44f9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-0be8949dc84b3fefec59b0df82393ad5.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-contrib/iconify-3.0.0/iconify-icon.min.js"></script>
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta property="og:title" content="Papers – Christophe Gouel">
<meta property="og:description" content="">
<meta property="og:site_name" content="Christophe Gouel">
</head>

<body class="nav-fixed quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
      window.dispatchEvent(new Event('resize'));
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a href="./index.html" class="navbar-brand navbar-brand-logo">
    </a>
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Christophe Gouel</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="./papers.html" aria-current="page"> 
<span class="menu-text">Papers</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-cv" role="link" data-bs-toggle="dropdown" aria-expanded="false">
      <i class="bi bi-file-pdf" role="img">
</i> 
 <span class="menu-text">CV</span>
    </a>
    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="nav-menu-cv">    
        <li>
    <a class="dropdown-item" href="./docs/cv_christophe_gouel_en.pdf">
 <span class="dropdown-text">English</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="./docs/cv_christophe_gouel_fr.pdf">
 <span class="dropdown-text">French</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item">
    <a class="nav-link" href="https://www.recs-solver.org/"> <i class="bi bi-box-arrow-right" role="img">
</i> 
<span class="menu-text">RECS solver</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#working-papers" id="toc-working-papers" class="nav-link active" data-scroll-target="#working-papers">Working papers</a></li>
  <li><a href="#peer-reviewed-journals" id="toc-peer-reviewed-journals" class="nav-link" data-scroll-target="#peer-reviewed-journals">Peer-reviewed journals</a></li>
  <li><a href="#book-chapters" id="toc-book-chapters" class="nav-link" data-scroll-target="#book-chapters">Book chapters</a></li>
  <li><a href="#briefs" id="toc-briefs" class="nav-link" data-scroll-target="#briefs">Briefs</a>
  <ul class="collapse">
  <li><a href="#english" id="toc-english" class="nav-link" data-scroll-target="#english">English</a></li>
  <li><a href="#french" id="toc-french" class="nav-link" data-scroll-target="#french">French</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Papers</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>For all my peer-reviewed articles, there is a freely available version, either pre-print or post-print. But if you want the publisher version and do not have the access, <a href="mailto:christophe.gouel@inrae.fr">send me an email</a>.</p>
<section id="working-papers" class="level2">
<h2 class="anchored" data-anchor-id="working-papers">Working papers</h2>
<a href="https://www.cepii.fr/CEPII/en/publications/wp/abstract.asp?NoDoc=14655"><strong>Carbon Bias of Tariffs: Are Fossil fuels the Culprits?</strong></a><br>
Bellora C., Fontagné L., <u>Gouel C.</u>, and Salib Y. (2025)<br>
[<a href="docs/carbon_bias_slides.html">Slides</a>]
<details>
<summary>
Abstract
</summary>
This paper revisits the existence of a carbon bias in trade policies, where emissions-intensive sectors receive lower trade protection than cleaner sectors. Using a stylized general equilibrium model that accounts for greenhouse gas emissions, we confirm the presence of a carbon bias but find it to be significantly smaller than previously estimated. Our analysis reveals that this bias is primarily driven by low tariffs on fossil fuels, particularly crude oil. Incorporating the finite nature of fossil fuel resources into the model reduces the responsiveness of fossil fuel production to tariff changes, effectively neutralizing the carbon bias. Furthermore, when accounting for domestic consumption taxes on fossil fuels in non-producing countries—which act as de facto tariffs—the bias shifts toward a pro-environmental stance. These findings underscore the importance of integrating energy markets’ specificities and domestic distortions into trade models to better account for the impact of trade policies on the environment.
</details>
</section>
<section id="peer-reviewed-journals" class="level2">
<h2 class="anchored" data-anchor-id="peer-reviewed-journals">Peer-reviewed journals</h2>
<a href="https://doi.org/10.1016/j.ecolecon.2025.108814"><strong>Outsourcing Decarbonization? How Trade Shaped France’s Carbon Footprint (2000–14)</strong></a> <iconify-icon role="img" inline="" icon="academicons:open-access" style="font-size: 1.2em;" aria-label="Icon open-access from academicons Iconify.design set." title="Icon open-access from academicons Iconify.design set."></iconify-icon><br>
Cotterlaz P. and <u>Gouel C.</u> (2026)<br>
<strong>Ecological Economics</strong>, 240, 108814. [<a href="https://doi.org/10.57745/KWXFK5">Programs</a>, <a href="https://www.cepii.fr/CEPII/fr/publications/lettre/abstract.asp?NoDoc=14667">Brief (fr)</a>]<br>

<details>
<summary>
Abstract
</summary>
This study examines the evolution of France’s carbon footprint from 2000 to 2014, with a particular focus on the role of international trade. During this period, France’s territorial emissions decreased by 18%, yet its consumption-based footprint declined by only 5%. This modest reduction reflects an increase in emissions embedded in imports, which grew from 45% to 54% of the total. Employing a novel structural decomposition analysis, we disentangle the contributions of scale, composition, and technique effects from a consumption perspective. Our approach advances traditional methods by explicitly distinguishing between domestic and foreign influences and by separately analyzing trade openness and the geographic reallocation of trade flows. The results underscore the dominance of the technique effect in reducing emissions (-28%), driven primarily by efficiency improvements abroad. However, the geographic composition effect led to a substantial increase in emissions (+18%), especially due to shifts toward more carbon-intensive trading partners prior to 2008. This pattern—characterized by a growing reliance on foreign improvements for emission reductions—likely foreshadows developments in other developed economies as domestic decarbonization advances. It highlights the need for greater coordination between trade and climate policies.
</details>
<a href="https://doi.org/10.3982/QE2329"><strong>The Role of Storage in Commodity Markets: Indirect Inference Based on Grains Data</strong></a> <iconify-icon role="img" inline="" icon="academicons:open-access" style="font-size: 1.2em;" aria-label="Icon open-access from academicons Iconify.design set." title="Icon open-access from academicons Iconify.design set."></iconify-icon><br>
<u>Gouel C.</u> and Legrand N. (2025)<br>
<strong>Quantitative Economics</strong>, 16(2), 705–747. [<a href="https://www.econometricsociety.org/publications/quantitative-economics/2025/05/01/The-Role-of-Storage-in-Commodity-Markets-Indirect-Inference-Based-on-Grain-Data/supp/QE2329SUPP.pdf">Appendix</a>, <a href="https://doi.org/10.5281/zenodo.14591285">Programs</a>, <a href="https://www.bayes-cid.com/pdf/issues/2023-summer/publications/CID%20Summer%202023%20Gouel%20et%20al.pdf">Brief</a>, <a href="https://hal.inrae.fr/hal-05108587v1/file/storage_II_slides.pdf">Slides</a>]
<details>
<summary>
Abstract
</summary>
We develop an indirect inference approach relying on a linear supply and demand model serving as an auxiliary model to provide the first full empirical test of the rational expectations commodity storage model. We build a rich storage model that incorporates a supply response and four structural shocks and show that exploiting information on both prices and quantities is critical for relaxing previous restrictive identifying assumptions and assessing the empirical consistency of the model’s features. Finally, we carry out a structural estimation on the aggregate index of the world’s most important staple food products. Our estimations show that supply shocks are the main drivers of food market dynamics and that our storage model is consistent with most of the moments in the data, including the high price persistence so far the subject of a long‐standing puzzle.
</details>
<a href="https://doi.org/10.1086/730591"><strong>Measuring Climate Change Impacts on Agriculture: An Equilibrium Perspective on Supply-Side Approaches</strong></a><br>
Gouel C. (2025)<br>
<strong>Journal of the Association of Environmental and Resource Economists</strong>, 12(1), 181–220. [<a href="https://hal.inrae.fr/hal-04829202v1/file/ricardian-trade-SA.pdf">Appendix</a>, <a href="https://hal.inrae.fr/hal-04829202v1/file/ricardian-trade-slides.pdf">Slides</a>, <a href="https://doi.org/10.7910/DVN/RFHQPK">Programs</a>, <a href="https://www.nber.org/papers/w30279">Pre-print</a>]
<details>
<summary>
Abstract
</summary>
Climate change impacts on agriculture are mostly estimated by supply-side reduced-form regressions, under the implicit assumption of constant crop prices. To test whether this assumption is innocuous, I use a quantitative trade model of global agricultural markets to emulate the findings of a supply-side approach and to calculate welfare changes accounting for price changes. The results show that both welfare measures are weakly correlated and can be of opposite signs and that the supply-side approach tends to underestimate the cost of climate change because of the imperfect substitutability of crops in demand.
</details>
<a href="https://doi.org/10.1016/j.jet.2024.105915"><strong>Interest Rate Dynamics and Commodity Prices</strong></a><br>
<u>Gouel C.</u>, Ma Q., and Stachurski J. (2024)<br>
<strong>Journal of Economic Theory</strong>, 222, 105915. [<a href="https://doi.org/10.57745/JV1JR6">Programs</a>, <a href="https://www.cepii.fr/CEPII/fr/publications/wp/abstract.asp?NoDoc=13921">Pre-print</a>]
<details>
<summary>
Abstract
</summary>
In economic studies and popular media, interest rates are routinely cited as a major factor behind commodity price fluctuations. At the same time, the transmission channels are far from transparent, leading to long-running debates on the sign and magnitude of interest rate effects. Purely empirical studies struggle to address these issues because of the complex interactions between interest rates, prices, supply changes, and aggregate demand. To move this debate to a solid footing, we extend the competitive storage model to include stochastically evolving interest rates. We establish general conditions for existence and uniqueness of solutions and provide a systematic theoretical and quantitative analysis of the interactions between interest rates and prices.
</details>
<a href="https://doi.org/10.1016/j.euroecorev.2023.104558"><strong>Love of Variety and Gains from Trade</strong></a><br>
<u>Gouel C.</u> and Jean S. (2023)<br>
<strong>European Economic Review</strong>, 158, 104558. [<a href="https://ars.els-cdn.com/content/image/1-s2.0-S0014292123001861-mmc1.pdf">Appendix</a>, <a href="https://doi.org/10.15454/U0QOAA">Programs</a>, <a href="https://hal.inrae.fr/hal-04179396v1/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
We show analytically and quantitatively how gains from trade depend on love of variety, defined as the extent to which an additional product variety generates benefits in either final or intermediate consumption. To do this, we use a multi-country, multi-sector heterogeneous-firm gravity trade model where love of variety is parameterized separately from product substitutability using a generalized CES demand function. Counterfactual simulations based on a calibrated version of this model show that the gains from trade commonly vary by a proportion of one to three depending on the value of the love-of-variety elasticity. Trade war simulations also point to the strong sensitivity of the assessed impacts. We conclude that love of variety may be an important determinant of the gains from trade, an aspect that has so far been overlooked for the sake of convenience in the modeling framework and due to lack of empirical estimates.
</details>
<a href="https://doi.org/10.1016/j.jeem.2020.102408"><strong>The Crucial Role of Domestic and International Market-Mediated Adaptation to Climate Change</strong></a> <iconify-icon role="img" inline="" icon="academicons:open-access" style="font-size: 1.2em;" aria-label="Icon open-access from academicons Iconify.design set." title="Icon open-access from academicons Iconify.design set."></iconify-icon><br>
<u>Gouel C.</u> and Laborde D. (2021)<br>
<strong>Journal of Environmental Economics and Management</strong>, 106, 102408. [<a href="https://ars.els-cdn.com/content/image/1-s2.0-S0095069620301315-mmc1.pdf">Appendix</a>, <a href="https://doi.org/10.15454/HYUURI">Programs</a>, <a href="https://voxeu.org/article/role-trade-adaptation-climate-change">Brief</a>]
<details>
<summary>
Abstract
</summary>
Climate change effects on agricultural yields will be uneven over the world. A few countries, mostly in high latitudes, may experience gains, while most will see average yield decrease. This paper aims to quantify the role of market-mediated adjustments in attenuating the effects of climate change by allowing the expression of the new climate-induced pattern of comparative advantages within and between countries. To do this, we develop a quantitative general equilibrium trade model where the representation of land use choice is inspired from modern Ricardian trade models. We use spatially explicit information from the agronomic literature about potential yields before and after climate change for calibration and counterfactual simulations. The results show that the climate-induced yield changes generate large price movements that incentivize adjustments in production and trade. Both production and trade adjustments contribute to reducing welfare losses globally, with production adjustments making the larger contribution.
</details>
<a href="https://doi.org/10.1002/ajae.12013"><strong>The Value of Public Information in Storable Commodity Markets: Application to the Soybean Market</strong></a><br>
Gouel C. (2020)<br>
<strong>American Journal of Agricultural Economics</strong>, 102(3), 846–865. [<a href="https://onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fajae.12013&amp;file=ajae12013-sup-0001-AppendixS1.pdf">Appendix</a>, <a href="https://doi.org/10.15454/YWAOKM">Programs</a>, <a href="https://hal.inrae.fr/hal-02622352v2/document">Post-print</a>]<br>

<details>
<summary>
Abstract
</summary>
This article provides a framework to estimate the potential effects and benefits of the provision of market information in storable commodity markets. This framework is applied to the case of production forecasts for the soybean market. A rational expectations storage model of the global soybean market accounting for both inter-annual and intra-annual market dynamics is built. Shocks that occur between planting and harvesting affect the size of the potential harvest. Estimates of the size of these shocks are reported publicly and affect the market equilibrium through adjustments to stock levels. By varying counterfactually the observability of seasonal shocks, we can estimate the efficiency gains related to the availability of advance information. They are equivalent to 2% of storage costs; the reduction of stock levels being the main channel explaining the welfare gains. The presence of advance information has a limited effect on inter-annual price volatility but redistributes price volatility during the season, increasing it just before harvest when almost all news has been received and stocks are tight and decreasing it after harvest. The effect of news shocks is stronger on higher order moments of the distribution with a strong decrease in skewness and kurtosis related to the lower frequency of price spikes.
</details>
<details>
<summary>
Award
</summary>
Winner of the European Association of Agricultural Economists’ 2020 Research Discovery Award.
</details>
<a href="https://doi.org/10.1093/ajae/aay030"><strong>Nutrition Transition and the Structure of Global Food Demand</strong></a><br>
<u>Gouel C.</u> and Guimbard H. (2019)<br>
<strong>American Journal of Agricultural Economics</strong>, 101(2), 383–403. [<a href="https://hal.archives-ouvertes.fr/hal-02043169/file/Global-Food-Demand-SA.pdf">Appendix</a>, <a href="https://doi.org/10.15454/9DZLRA">Programs</a>, <a href="https://doi.org/10.15454/9DZLRA/EEBC53">MAIDADS Simulator (Excel spreadsheet)</a>, <a href="https://hal.archives-ouvertes.fr/hal-02043169/document">Post-print</a>, <a href="https://www.cepii.fr/CEPII/en/publications/lettre/abstract.asp?NoDoc=10263">Brief (fr)</a>]
<details>
<summary>
Abstract
</summary>
Estimating future demand for food is a critical aspect of global food security analyses. The process linking dietary changes to wealth is known as the nutrition transition and presents well-identified features that help to predict consumption changes in poor countries. This study proposes to represent the nutrition transition with a nonhomothetic, flexible-in-income demand system. The resulting model is estimated statistically based on cross-sectional information from FAOSTAT. The model captures the main features of the nutrition transition: rise in demand for calories associated with income growth; diversification of diets away from starchy staples; and a large increase in caloric demand for animal-based products, fats, and sweeteners. The estimated model is used to project food demand between 2010 and 2050 based on a set of plausible futures (trend projections and Shared Socioeconomic Pathways scenarios). The main results of these projections are: (a) global food demand will increase by 47%, less than half the growth in the previous four decades; (b) this growth will be attributable mainly to lower-middle-income and low-income countries; (c) the structure of global food demand will change over the period, with a doubling of demand for animal-based calories and a much smaller 19% increase in demand for starchy staples; and (d) the analysis of a range of population and income projections reveals important uncertainties—depending on the scenario, the projected increases in demand for animal-based and vegetal-based calories range from 74% to 114%, and from 20% to 42%, respectively.
</details>
<a href="https://doi.org/10.1002/jae.2553"><strong>Estimating the Competitive Storage Model with Trending Commodity Prices</strong></a><br>
<u>Gouel C.</u> and Legrand N. (2017)<br>
<strong>Journal of Applied Econometrics</strong>, 32(4), 744–763. [<a href="https://hal.archives-ouvertes.fr/hal-01584507/file/JAE-Paper-SA.pdf">Appendix</a>, <a href="http://qed.econ.queensu.ca/jae/datasets/gouel001/">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01584507/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
We present a method to estimate jointly the parameters of a standard commodity storage model and the parameters characterizing the trend in commodity prices. This procedure allows the influence of a possible trend to be removed without restricting the model specification, and allows model and trend selection based on statistical criteria. The trend is modeled deterministically using linear or cubic spline functions of time. The results show that storage models with trend are always preferred to models without trend. They yield more plausible estimates of the structural parameters, with storage costs and demand elasticities that are more consistent with the literature. They imply occasional stockouts, whereas without trend the estimated models predict no stockouts over the sample period for most commodities. Moreover, accounting for a trend in the estimation implies price moments closer to those observed in commodity prices. Our results support the empirical relevance of the speculative storage model, and show that storage model estimations should not neglect the possibility of long-run price trends.
</details>
<a href="https://doi.org/10.1093/ajae/aaw020"><strong>Trade Policy Coordination and Food Price Volatility</strong></a><br>
Gouel C. (2016)<br>
<strong>American Journal of Agricultural Economics</strong>, 98(4), 1018–1037. [<a href="https://hal.archives-ouvertes.fr/hal-01532572/file/Appendix.pdf">Appendix</a>, <a href="https://hal.archives-ouvertes.fr/hal-01532572/file/Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01532572/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
Many countries adjust their trade policies counter-cyclically with food prices, to the extent that the use of restrictions by food-exporting countries has occasionally threatened the food security of food-importing countries. These trade policies are inconsistent with the terms-of-trade motivation often retained to characterize the payoff frontier of self-enforcing trade agreements, as they can worsen the terms of trade of the countries that apply them. This article analyzes trade policy coordination when trade policies are driven by terms-of-trade effects and a desire to reduce domestic food price volatility. This framework implies that importing and exporting countries have incentives to deviate from cooperation at different periods: the latter when prices are high and the former when prices are low. Since staple food prices tend to have asymmetric distributions, with more prices below than above the mean but with occasional spikes, a self-enforcing agreement generates asymmetric outcomes. Without cooperation, an importing country uses its trade policy more frequently because of the concentration of prices below the mean, but an exporting country has a greater incentive to deviate from a cooperative trade policy because positive deviations from the mean price are larger than negative ones. Thus, the asymmetry of the distribution of commodity prices can make it more difficult to discipline export taxes than tariffs in trade agreements.
</details>
<a href="https://doi.org/10.1093/oep/gpv089"><strong>Managing Food Price Volatility in a Large Open Country: The Case of Wheat in India</strong></a><br>
<u>Gouel C.</u>, Gautam M. and Martin W. J. (2016)<br>
<strong>Oxford Economic Papers</strong>, 68(3), 811–835. [<a href="https://hal.archives-ouvertes.fr/hal-01581612/file/Appendix.pdf">Appendix</a>, <a href="https://hal.archives-ouvertes.fr/hal-01581612/file/OEP2016-Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01581612/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
India has pursued an active food security policy for many years by using a combination of trade policy interventions, public distribution of food staples, and assistance to farmers through minimum support prices defended by public stocks. This approach has been quite successful in stabilizing staple food prices, but comes at a high cost, and with potential risks of unmanageable stock accumulation. Based on a rational expectations storage model representing the Indian wheat market and its relation to the rest of the world, we analyse the cost and welfare implications of this policy, and unpack the contribution of its various elements. To analyse alternative policies, we assume that social welfare includes an objective of price stabilization and assess optimal policies corresponding to this objective. We consider fully optimal policies under commitment as well as optimal simple rules, and show that adopting simple rules can achieve most of the gains from fully optimal policies.
</details>
<a href="https://doi.org/10.1093/wber/lht018"><strong>Optimal Food Price Stabilization in a Small Open Developing Country</strong></a><br>
<u>Gouel C.</u> and Jean S. (2015)<br>
<strong>World Bank Economic Review</strong>, 29(1), 72–101. [<a href="https://hal.archives-ouvertes.fr/hal-01173054/file/Appendix.pdf">Appendix</a>, <a href="https://hal.archives-ouvertes.fr/hal-01173054/file/WBER2014-Gouel-and-Jean-Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01173054/document">Post-print</a>]<br>

<details>
<summary>
Abstract
</summary>
This paper analyzes the use of storage and trade policies to achieve food price stabilization in a small open developing country. Optimal stabilization policies are identified using a rational expectations storage model with risk-averse consumers and incomplete markets. Without public intervention, price dynamics are driven by domestic productive shocks and international prices. On its own, an optimal storage policy is found to be detrimental to consumers because its stabilizing benefits leak to the world market. In contrast, an optimal combination of storage and trade policies results in a powerful stabilization of domestic food prices. However, such an optimal combination is shown to entail two serious drawbacks: its distributive impacts are large compared to its efficiency benefits, and by distorting excess supply curves, it may aggravate high world price episodes.
</details>
<details>
<summary>
Award
</summary>
Winner of the European Association of Agricultural Economists’ Quality of Policy Contribution Award in honor of Giovanni Anania.
</details>
<a href="https://doi.org/10.1093/wber/lht015"><strong>Food Security and Storage in the Middle East and North Africa</strong></a><br>
Larson D. F., Lampietti J., <u>Gouel C.</u>, Cafiero C. and Roberts J. (2014)<br>
<strong>World Bank Economic Review</strong>, 28(1), 48–73. [<a href="https://hal.archives-ouvertes.fr/hal-01186946/file/WBER2014-Larson-Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01186946/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
In times of highly volatile commodity markets, governments often try to protect their populations from rapidly rising food prices, which can be particularly harmful for the poor. A potential solution for food-deficit countries is to hold strategic reserves that can be called on when international prices spike. But how large should strategic stockpiles be, and what rules should govern their release? In this paper, we develop a dynamic competitive storage model for wheat in the Middle East and North Africa region, where imported wheat is the most significant component of the average diet. We analyze a strategy that sets aside wheat stockpiles, which can be used to keep domestic prices below a targeted price. Our analysis shows that if the target price is set high and reserves are adequate, the strategy can be effective and robust. Contrary to most interventions, strategic storage policies are counter-cyclical, and when the importing region is sufficiently large, a regional policy can smooth global prices. Simulations indicate that this is the case for the Middle East and North Africa region. Nevertheless, the policy is more costly than a procyclical policy similar to food stamps that uses targeted transfers to directly offset high prices with a subsidy.
</details>
<a href="https://doi.org/10.1093/ajae/aat016"><strong>Rules versus Discretion in Food Storage Policies</strong></a><br>
Gouel C. (2013)<br>
<strong>American Journal of Agricultural Economics</strong>, 95(4), 1029–1044. [<a href="https://hal.archives-ouvertes.fr/hal-01636279/file/Appendix.pdf">Appendix</a>, <a href="https://hal.archives-ouvertes.fr/hal-01636279/file/Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01636279/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
This article compares various policies in a rational expectations food storage model with risk-averse consumers and missing insurance markets calibrated to represent a developing country. I consider an optimal storage policy under discretion and two optimal simple rules: a constant private storage subsidy and a price band. The storage subsidy achieves welfare gains similar to the discretionary policy. The price band maximizing social welfare is a price-peg scheme: The floor and ceiling prices are the same, and the capacity constraint represents 11% of the steady-state production level. This price band achieves three-quarters of the gains from the optimal policy under discretion.
</details>
<a href="https://doi.org/10.1007/s10614-012-9318-y"><strong>Comparing Numerical Methods for Solving the Competitive Storage Model</strong></a><br>
Gouel C. (2013)<br>
<strong>Computational Economics</strong>, 41(2), 267–295. [<a href="https://hal.archives-ouvertes.fr/hal-01136976/file/CE2013-Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01136976/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
This paper compares numerical methods for solving the competitive storage model. Because storage implies a nonnegativity constraint on stocks, the solution methods must be considered carefully. The model is solved using value function iteration and several projection approaches, including parameterised expectations and decision rules approximation. In considering a storage model with convenience yield, in which the inequality constraint is smoothed, perturbation methods are also applied. Parameterised expectations approximation proves to be the most accurate method, whereas perturbation techniques are shown inadequate for solving this highly nonlinear model. The endogenous grid method allows rapid solution if supply is assumed to be inelastic.
</details>
<a href="https://doi.org/10.1016/j.euroecorev.2012.10.003"><strong>Optimal Food Price Stabilisation Policy</strong></a><br>
Gouel C. (2013)<br>
<strong>European Economic Review</strong>, 57, 118–134. [<a href="https://hal.archives-ouvertes.fr/hal-01019459/file/Appendix.pdf">Appendix</a>, <a href="https://hal.archives-ouvertes.fr/hal-01019459/file/EER2013-Programs.zip">Programs</a>, <a href="https://hal.archives-ouvertes.fr/hal-01019459/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
This paper proposes a framework for designing optimal food price stabilisation policies in a self-sufficient developing country. It uses a rational expectations storage model with risk-averse consumers and incomplete markets. Government stabilises food prices by carrying public stock and by applying a state-contingent subsidy/tax to production. The policy rules are designed to maximise intertemporal welfare. The optimal policy under commitment crowds out all private stockholding activity by removing the profit opportunity from speculation. The countercyclical subsidy/tax to production helps price stabilisation by subsidising production in periods of scarcity and by taxing it in periods of glut. It contributes little to welfare gains, most of which come from stabilisation achieved through public storage.
</details>
<a href="https://doi.org/10.1111/j.1467-6419.2010.00634.x"><strong>Agricultural Price Instability: A Survey of Competing Explanations and Remedies</strong></a><br>
Gouel C. (2012)<br>
<strong>Journal of Economic Surveys</strong>, 26(1), 129–156. [<a href="https://hal.archives-ouvertes.fr/hal-01001218/document">Post-print</a>]
<details>
<summary>
Abstract
</summary>
There are two explanations for agricultural price dynamics. One follows cobweb logic and models fluctuations driven by expectation errors but emphasises that these expectations create complex dynamics and possibly chaos. The other stems from the rational expectations tradition of dynamics driven by real shocks. The empirical evidence tends to support the latter, but is not conclusive. The rational expectations model generates an optimal dynamic path from which no improvement can be expected from public intervention. However, if we take account of all the potential market failures in agricultural markets, and especially in developing countries, this conclusion might require some qualifications, although an appropriate policy design for stability has still to be achieved. This paper surveys the positive and normative literature on agricultural prices, highlighting empirical evidence and identifying remaining unresolved issues.
</details>
<a href="https://doi.org/10.1016/j.econmod.2011.06.014"><strong>Sensitive Products in the Doha Negotiations: The Case of European and Japanese Market Access</strong></a><br>
<u>Gouel C.</u>, Mitaritona C. and Ramos M.P. (2011)<br>
<strong>Economic Modelling</strong>, 28(6), 2395–2403. [<a href="https://ideas.repec.org/p/cii/cepidt/2010-20.html">Pre-print</a>]
<details>
<summary>
Abstract
</summary>
Given the highly concentrated distribution of agricultural protection, allowing in the negotiations too many exceptions through sensitive products puts at risk the objectives of World Trade Organization. This issue is difficult to analyze with the commonly used applied trade models, because they represent trade flows at an aggregate level, while sensitive products are picked at the product level and their protection, under the form of tariff-rate quotas, is contingent on the level of imports. This paper assesses the effect of these exceptions, based on the case of agricultural trade protection in Europe and Japan, two countries where tariff dismantling in the agricultural sector is a particularly sensitive issue. Since agricultural border protection is heterogeneous, we avoid aggregation bias by extending a multi-country computable general equilibrium model to the product level. This allows us to represent trade policies explicitly and to account for their interdependencies. The results suggest that consideration of sensitive products strongly limits the potential gains from a possible agriculture agreement at Doha. Moreover, there is no aggregate trade-off between decreasing tariffs and increasing/opening quotas. To achieve “substantial” market access improvements in the agricultural sector, the objective should be most favored nation tariff reduction.
</details>
</section>
<section id="book-chapters" class="level2">
<h2 class="anchored" data-anchor-id="book-chapters">Book chapters</h2>
<p><a href="https://doi.org/10.1016/bs.hesagr.2022.03.004"><strong>Trade in Agricultural and Food Products</strong></a><br>
Gaigné C. and <u>Gouel C.</u> (2022)<br>
in Barrett C. B. and Just D. R. (ed.) <em>Handbook of Agricultural Economics.</em> Volume 6, Chapter 88 (pp.&nbsp;4845–4931). Elsevier. [<a href="https://hal.inrae.fr/hal-03707237/document">Appendix</a>, <a href="docs/TradeAg.pdf">Pre-print</a>]</p>
<p><a href="http://www.nber.org/chapters/c12816"><strong>Food Price Volatility and Domestic Stabilization Policies in Developing Countries</strong></a><br>
Gouel C. (2014)<br>
in Chavas J.-P., Hummels D. and Wright B. (ed.) <em>The Economics of Food Price Volatility.</em> Chapter 7 (pp.&nbsp;261–306). Chicago: University of Chicago Press.</p>
<p><strong>International Trade, Price Volatility and Standards for Sustainability</strong><br>
Jean S., Bricas N. and <u>Gouel C.</u> (2013)<br>
in Esnouf C., Russel M. and Bricas N. (ed.) <em>Food System Sustainability: Insights From duALIne.</em> Chapter 8 (pp.&nbsp;158–175). Cambridge, UK: Cambridge University Press.</p>
<p><a href="https://www.cepii.fr/PDF_PUB/em/2009/em2009-05.pdf"><strong>Comment expliquer la flambée des prix agricoles</strong></a><br>
Gouel C. (2008)<br>
in CEPII (ed.) <em>L'Économie Mondiale 2009.</em> (pp.&nbsp;74–86). Paris: La Découverte.</p>
</section>
<section id="briefs" class="level2">
<h2 class="anchored" data-anchor-id="briefs">Briefs</h2>
<section id="english" class="level3">
<h3 class="anchored" data-anchor-id="english">English</h3>
<p><a href="https://cepr.org/voxeu/columns/role-trade-adaptation-climate-change"><strong>The Role of Trade in Adaptation to Climate Change</strong></a><br>
<u>Gouel C.</u> and Laborde D. (2019)<br>
<strong>VoxEU Column</strong>.</p>
<p><a href="https://www.cepii.fr/CEPII/en/publications/lettre/abstract.asp?NoDoc=1784"><strong>American and European Agricultural Market Access: A Concern for The South?</strong></a><br>
<u>Gouel C.</u> and Ramos M.P. (2008)<br>
<strong>La Lettre du CEPII</strong>, N°277.</p>
</section>
<section id="french" class="level3">
<h3 class="anchored" data-anchor-id="french">French</h3>
<p><a href="https://www.cepii.fr/CEPII/fr/publications/lettre/abstract.asp?NoDoc=14667"><strong>Comment le commerce international a façonné l’empreinte carbone de la France</strong></a><br>
Cotterlaz P. and <u> Gouel C.</u> (2025)<br>
<strong>La Lettre du CEPII</strong>, N°457.</p>
<p><a href="https://www.cepii.fr/CEPII/en/publications/lettre/abstract.asp?NoDoc=10263"><strong>La demande alimentaire mondiale en 2050</strong></a><br>
<u>Gouel C.</u> and Guimbard H. (2017)<br>
<strong>La Lettre du CEPII</strong>, N°377.</p>
<p><a href="http://ageconsearch.umn.edu/record/265503"><strong>Volatilité des cours des commodités agricoles et politiques de stabilisation</strong></a><br>
Féménia F. and <u>Gouel C.</u> (2016)<br>
<strong>INRA Sciences Sociales</strong>, N°1–2/2016.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp("https:\/\/www\.christophegouel\.com");
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>